<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>汇编语言学习(2) | Raechellia</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="寄存器(CPU工作原理)">
<meta property="og:type" content="article">
<meta property="og:title" content="汇编语言学习(2)">
<meta property="og:url" content="http://yoursite.com/2020/03/04/%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0-2/index.html">
<meta property="og:site_name" content="Raechellia">
<meta property="og:description" content="寄存器(CPU工作原理)">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://yoursite.com/2020/03/04/%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0-2/huibian-2-1.png">
<meta property="og:image" content="http://yoursite.com/2020/03/04/%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0-2/huibian-2-2.png">
<meta property="og:image" content="http://yoursite.com/2020/03/04/%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0-2/huibian-2-3.png">
<meta property="og:image" content="http://yoursite.com/2020/03/04/%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0-2/huibian-2-4.png">
<meta property="og:image" content="http://yoursite.com/2020/03/04/%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0-2/huibian-2-6.png">
<meta property="og:image" content="http://yoursite.com/2020/03/04/%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0-2/huibian-2-5.png">
<meta property="og:image" content="http://yoursite.com/2020/03/04/%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0-2/huibian-2-7.png">
<meta property="og:image" content="http://yoursite.com/2020/03/04/%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0-2/huibian-2-8.png">
<meta property="og:image" content="http://yoursite.com/2020/03/04/%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0-2/huibian-2-9.png">
<meta property="article:published_time" content="2020-03-04T06:19:50.000Z">
<meta property="article:modified_time" content="2020-03-06T07:21:22.197Z">
<meta property="article:author" content="Raechellia">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://yoursite.com/2020/03/04/%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0-2/huibian-2-1.png">
  
  <link rel="stylesheet" href="//cdn.bootcss.com/highlight.js/9.2.0/styles/github.min.css">
  <script src="//cdn.bootcss.com/highlight.js/9.2.0/highlight.min.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', (event) => {
      document.querySelectorAll('pre code').forEach((block) => {
        hljs.highlightBlock(block);
      });
    });
  </script>
  
<link rel="stylesheet" href="/css/index.css">

<meta name="generator" content="Hexo 4.2.0"></head>

<body style="


  background-color: #eff0f6

">
  <div id="container">
    <nav id="nav">
  <header class="header">
    <a href="/" class="title">Raechellia</a>
  </header>
  <div class="ctnWrap">
    <div class="icons">
      
        
          
            <a href="cydia://url/https://cydia.saurik.com/api/share#?source=https://raechellia.github.io/" target="_blank" class="nav-icn iconfont icon-cydia"></a>
          
        
          
            <a href="/image/Wechat.jpg" target="_blank" class="nav-icn iconfont icon-wechat"></a>
          
        
      
    </div>
    <div class="menu">
      
        
            <a href="/" class="nav-menu ">HOME</a>
          
        
            <a href="/tags/Stuffs" class="nav-menu ">STUFFS</a>
          
        
            <a href="/archives" class="nav-menu ">ARCHIVE</a>
          
        
            <a href="/about" class="nav-menu ">ABOUT</a>
          
        
      
    </div>
  </div>
</nav>
    <div id="main"><section class="article">
  <h2 class="title">汇编语言学习(2)</h2>
  <p class="sub">3月 4, 2020</p>
  <article class="content">
    <p>CPU由运算器、控制器、寄存器等器件组成，这些器件靠内部总线相连。<br>区别：<br>内部总线实现CPU内部各个器件之间的连接。<br>外部总线实现CPU和主板上其他器件的联系。</p>
<p>8086有14个寄存器：AX,BX,CX,DX,SP,BP,SI,DI,DS,ES,SS,CS,IP,PSW。</p>
<h1 id="2-1-通用寄存器"><a href="#2-1-通用寄存器" class="headerlink" title="2.1 通用寄存器"></a>2.1 通用寄存器</h1><p>8086CPU所有的寄存器都是16位的，可以存放两个字节。<br>AX、BX、CX、DX通常用来存放一般数据被称为通用寄存器。<br><img src="/2020/03/04/%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0-2/huibian-2-1.png" alt></p>
<p>举个例子<br>数据：18<br>二进制表示：10010<br>在寄存器AX中的存储：<br><img src="/2020/03/04/%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0-2/huibian-2-2.png" alt></p>
<p>那么一个16位寄存器存储最大值为 2的16次方-1<br>为了保证兼容性，这四个寄存器都可以分为两个独立的8位寄存器使用。(向下兼容)<br>AX 可以分为AH(0<del>7)和AL(8</del>15)<br>BX 可以分为BH和BL<br>CX 可以分为CH和CL<br>DX 可以分为DH和DL<br><img src="/2020/03/04/%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0-2/huibian-2-3.png" alt></p>
<h1 id="2-2-字在寄存器中的存储"><a href="#2-2-字在寄存器中的存储" class="headerlink" title="2.2 字在寄存器中的存储"></a>2.2 字在寄存器中的存储</h1><p>word = 2B<br>1个字=2个字节</p>
<h1 id="2-3-几条汇编指令"><a href="#2-3-几条汇编指令" class="headerlink" title="2.3 几条汇编指令"></a>2.3 几条汇编指令</h1><p>汇编指令不区分大小写</p>
<p>|汇编指令|控制CPU完成的操作|用高级语言的语法描述|<br>|mov ax, 18|将8送入AX|AX = 18|<br>|–|–|–|<br>|mov ah, 78|将78送入AH|AH = 78|<br>|add ax, 8|讲寄存器AX中的数值加上8|AX = AX + 8|<br>|mov ax, bx|将寄存器BX中的数据送入寄存器AX|AX = BX|<br>|add ax, bx|将AX, BX中的内容相加， 结果保存在AX中|AX = AX + BX|</p>
<p>举个例子<br>原来AX中的值：0000H 原来BX中的值：0000H</p>
<p>例1：</p>
<table>
<thead>
<tr>
<th>程序段中的指令</th>
<th>指令执行后AX中的数据</th>
<th>指令执行后BX中的数据</th>
</tr>
</thead>
<tbody><tr>
<td>mov ax, 4E20H</td>
<td>4E20H</td>
<td>0000H</td>
</tr>
<tr>
<td>add ax, 1406H</td>
<td>6226H</td>
<td>0000H</td>
</tr>
<tr>
<td>mov bx, 2000H</td>
<td>6226H</td>
<td>2000H</td>
</tr>
<tr>
<td>add ax, bx</td>
<td>8226H</td>
<td>2000H</td>
</tr>
<tr>
<td>mov bx, ax</td>
<td>8226H</td>
<td>8226H</td>
</tr>
<tr>
<td>add ax, ba</td>
<td>044CH</td>
<td>8226H</td>
</tr>
</tbody></table>
<p>例2：</p>
<table>
<thead>
<tr>
<th>程序段中的指令</th>
<th>指令执行后AX中的数据</th>
<th>指令执行后BX中的数据</th>
</tr>
</thead>
<tbody><tr>
<td>mov ax, 001AH</td>
<td>001AH</td>
<td>0000H</td>
</tr>
<tr>
<td>mov bx, 0026H</td>
<td>001AH</td>
<td>0026H</td>
</tr>
<tr>
<td>add al, bl</td>
<td>0040H</td>
<td>0026H</td>
</tr>
<tr>
<td>add ah, bl</td>
<td>2640H</td>
<td>0026H</td>
</tr>
<tr>
<td>add bh, al</td>
<td>2640H</td>
<td>4026H</td>
</tr>
<tr>
<td>mov ah, 0</td>
<td>0040H</td>
<td>4026H</td>
</tr>
<tr>
<td>add al, 85H</td>
<td>00C5H</td>
<td>4026H</td>
</tr>
<tr>
<td>add al, 93H</td>
<td>0058H</td>
<td>4026H</td>
</tr>
</tbody></table>
<p>注意：<br>这里的丢失，指的是进制位不能在8位寄存器中保存，但是CPU不是真的丢弃这个进制位。</p>
<h1 id="2-4-物理地址"><a href="#2-4-物理地址" class="headerlink" title="2.4 物理地址"></a>2.4 物理地址</h1><p>CPU访问内存单元时要给出内存单元地址。所有的内存单元构成的存储空间是一个一维的线性空间。</p>
<h1 id="2-5-16位结构的CPU"><a href="#2-5-16位结构的CPU" class="headerlink" title="2.5 16位结构的CPU"></a>2.5 16位结构的CPU</h1><p>16位CPU有以下特征：</p>
<ol>
<li>运算器一次最多可以处理16位的数据</li>
<li>寄存器的最大宽度为16位</li>
<li>寄存器和运算器之间的通路是16位的</li>
</ol>
<p>所以说懂得16位CPU你就可以懂得64位CPU</p>
<h1 id="2-6-8086CPU给出物理地址的方法"><a href="#2-6-8086CPU给出物理地址的方法" class="headerlink" title="2.6 8086CPU给出物理地址的方法"></a>2.6 8086CPU给出物理地址的方法</h1><p>8086有20位地址总线，可传送20位地址，寻址能力位1M<br>8086内部为16位结构，它只能传送16位的地址，表现出的寻址能力却只有64K</p>
<p>8086CPU采用一种在内部用两个16位地址合成的方法来形成一个20位的物理地址<br><img src="/2020/03/04/%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0-2/huibian-2-4.png" alt="8086CPU相关部件的逻辑结构"></p>
<p>注意：<br>当8086CPU读取内存时，发生这么一些事情：</p>
<ol>
<li>CPU中的相关部件提供两个16位的地址，一个称为段地址，另一个称为偏移地址</li>
<li>段地址和偏移地址通过内部总线送入一个称为地址加法器的部件</li>
<li>地址加法器将两个16位地址合并成一个20位的地址</li>
<li>。。。</li>
</ol>
<h1 id="2-7-“段地址X16-偏移地址-物理地址”的本质含义"><a href="#2-7-“段地址X16-偏移地址-物理地址”的本质含义" class="headerlink" title="2.7 “段地址X16+偏移地址=物理地址”的本质含义"></a>2.7 “段地址X16+偏移地址=物理地址”的本质含义</h1><p>概念“段地址X16+偏移地址=物理地址”<br>段地址X16可以看成二进制数向左移动4位<br><img src="/2020/03/04/%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0-2/huibian-2-6.png" alt></p>
<p>地址加法器工作原理<br><img src="/2020/03/04/%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0-2/huibian-2-5.png" alt></p>
<h1 id="2-8-段的概念"><a href="#2-8-段的概念" class="headerlink" title="2.8 段的概念"></a>2.8 段的概念</h1><p>内存没有分段，段的划分来自于CPU，由于8086CPU用”段地址X16+偏移地址=物理地址”的方式给出内存单元的物理地址，使得我们可以用分段的方式来管理内存。</p>
<p>CPU可以用不同的段地址和偏移地址形成同一个物理地址。<br><img src="/2020/03/04/%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0-2/huibian-2-7.png" alt></p>
<p>描述“数据在21F60H内存单元中”<br>对于8086PC机的两种描述：</p>
<ol>
<li>数据存在内存单元2000:1F60单元中</li>
<li>数据存在内存的2000段中的1F60H单元中。</li>
</ol>
<h1 id="2-9-段寄存器"><a href="#2-9-段寄存器" class="headerlink" title="2.9 段寄存器"></a>2.9 段寄存器</h1><p>段寄存器就是提供段地址的。<br>8086CPU有4个段寄存器：CS、DS、SS、ES<br>当8086CPU要访问内存时，由这四个段寄存器提供内存单元的段地址</p>
<h1 id="2-10-CS和IP"><a href="#2-10-CS和IP" class="headerlink" title="2.10 CS和IP"></a>2.10 CS和IP</h1><p>CS和IP是8086CPU中最关键的寄存器，他们指示了CPU当前要读取指令的地址。<br>CS为代码段寄存器。 IP为指令指针寄存器。<br><img src="/2020/03/04/%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0-2/huibian-2-8.png" alt><br>工作流程：</p>
<ol>
<li>从CS:IP指向内存单元读取指令，读取的指令进入指令缓冲器</li>
<li>IP = IP + 所读取指令的长度，从而指向下一条指令</li>
<li>执行指令。转到1，反复执行</li>
</ol>
<p>8086PC工作过程简要描述<br>在8086CPU加电启动或复位后(即CPU刚开始工作时)CS和IP被设置为CS=FFFFH，IP=0000H<br>即在8086PC机刚启动时，CPU从内存FFFF0H单元中读取指令执行<br>FFFF0H单元中的指令是8086PC机开机后执行的第一条指令</p>
<h1 id="2-11-修改CS、IP的指令"><a href="#2-11-修改CS、IP的指令" class="headerlink" title="2.11 修改CS、IP的指令"></a>2.11 修改CS、IP的指令</h1><p>在CPU中，程序员能够用指令读写的部件只有寄存器，程序员可以通过改变寄存器中的内容实现对CPU的控制。<br>CPU从何处执行指令是由CS、IP中的内容决定的，程序员可以通过改变CS、IP中的内容来控制CPU执行目标指令</p>
<p>转移指令：<br>同时修改CS、IP的内容：<br>jmp 段地址:偏移地址<br>jmp 2AE3:3    -&gt;    2AE33<br>jmp 3:0B16    -&gt;    00B46</p>
<p>仅仅修改IP的内容<br>jmp 某一合法寄存器<br>jmp ax    类似与 mov IP, ax<br>jmp bx</p>
<p>内存中存放的机器码和对应汇编指令情况<br>CS=2000H IP=0000H<br><img src="/2020/03/04/%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0-2/huibian-2-9.png" alt></p>
<ol>
<li>mov ax, 6622H</li>
<li>jup 1000:3</li>
<li>mov ax, 0000</li>
<li>mov bx, ax</li>
<li>jmp bx</li>
<li>mov ax, 0123</li>
<li>转到3</li>
</ol>
<h1 id="2-12-代码段"><a href="#2-12-代码段" class="headerlink" title="2.12 代码段"></a>2.12 代码段</h1><p>对于8086PC机，在编程时，可以根据需要，将一组内存单元定义为一个段。<br>可以将长度为N的一组代码，存在一组地址连续、起始地址为16的倍数的内存单元中，这段内存是用来存放代码的，从而定义了一个代码段。</p>

  </article>
  <footer class="f-cf">
    
      <a href="/2020/03/04/%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0-3/" class="link f-fl">⟵汇编语言学习(3)</a>
    
    
      <a href="/2020/03/04/%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0-1/" class="link f-fr">汇编语言学习(1)⟶</a>
    
  </footer>
</section></div>
    <footer id="footer" class="f-cf">
  z839994029@icloud.com
  
    
      
        · <a href="cydia://url/https://cydia.saurik.com/api/share#?source=https://raechellia.github.io/" target="_blank" class="nav-icn">Cydia</a>
      
    
      
        · <a href="/image/Wechat.jpg" target="_blank" class="nav-icn">Wechat</a>
      
    
  
  <span class="copyright">© 2020 Card. All rights reserved raechellia.github.io</span>
</footer>
  </div>
</body>
</html>